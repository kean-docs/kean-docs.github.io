{"identifier":{"url":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/loading-data","interfaceLanguage":"swift"},"metadata":{"title":"Loading Data","modules":[{"name":"Nuke"}],"role":"collectionGroup","roleHeading":"API Collection"},"seeAlsoSections":[{"title":"Customization","identifiers":["doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/image-processing","doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/image-formats","doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/ImagePipelineDelegate"],"generated":true}],"hierarchy":{"paths":[["doc:\/\/com.github.kean.nuke\/documentation\/Nuke"]]},"kind":"article","schemaVersion":{"minor":3,"patch":0,"major":0},"topicSections":[{"identifiers":["doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoading","doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoader","doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/Cancellable"],"title":"Data Loader"}],"variants":[{"paths":["\/documentation\/nuke\/loading-data"],"traits":[{"interfaceLanguage":"swift"}]}],"abstract":[{"type":"text","text":"Learn how pipeline loads data."}],"sections":[],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","level":2,"text":"Overview","anchor":"Overview"},{"inlineContent":[{"type":"reference","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoader","isActive":true},{"type":"text","text":" uses "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/reference\/foundation\/nsurlsession"},{"type":"text","text":" to load image data. The data is cached on disk using "},{"identifier":"https:\/\/developer.apple.com\/reference\/foundation\/urlcache","type":"reference","isActive":true},{"text":", which by default is initialized with a memory capacity of 0 MB (Nuke only stores processed images in memory) and a disk capacity of 150 MB.","type":"text"}],"type":"paragraph"},{"style":"tip","type":"aside","content":[{"type":"paragraph","inlineContent":[{"text":"See ","type":"text"},{"identifier":"https:\/\/kean.blog\/post\/image-caching","isActive":true,"type":"reference"},{"type":"text","text":" to learn more about HTTP cache. To learn more about caching in Nuke and how to configure it, see "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/caching"},{"text":".","type":"text"}]}],"name":"Tip"},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"URLSession"},{"text":" class natively supports the following URL schemes: ","type":"text"},{"type":"codeVoice","code":"data"},{"text":", ","type":"text"},{"code":"file","type":"codeVoice"},{"type":"text","text":", "},{"type":"codeVoice","code":"ftp"},{"type":"text","text":", "},{"code":"http","type":"codeVoice"},{"type":"text","text":", and "},{"type":"codeVoice","code":"https"},{"text":".","type":"text"}]},{"inlineContent":[{"text":"The default ","type":"text"},{"type":"reference","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoader","isActive":true},{"type":"text","text":" works great for most situations, but if you need to provide a custom networking layer, you can use a "},{"identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoading","isActive":true,"type":"reference"},{"text":" protocol. See also, ","type":"text"},{"type":"reference","identifier":"https:\/\/github.com\/kean\/Nuke-Alamofire-Plugin","isActive":true},{"text":".","type":"text"}],"type":"paragraph"},{"text":"Monitoring Network Requests","anchor":"Monitoring-Network-Requests","level":2,"type":"heading"},{"inlineContent":[{"text":"Nuke can be used with ","type":"text"},{"type":"reference","identifier":"https:\/\/github.com\/kean\/Pulse","isActive":true},{"type":"text","text":" for monitoring network traffic."}],"type":"paragraph"},{"code":["(ImagePipeline.shared.configuration.dataLoader as? DataLoader)?.delegate = URLSessionProxyDelegate()"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The same "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoader\/delegate"},{"type":"text","text":" can be used for modifying data loader behavior, e.g. for handling authentication requests and other aspects of data loading."}]},{"code":["\/\/ The delegate is retained by the `DataLoader`.","(ImagePipeline.shared.configuration.dataLoader as? DataLoader)?.delegate = YourDelegate()","","final class YourDelegate: URLSessionTaskDelegate {","    func urlSession(_ session: URLSession, task: URLSessionTask, didReceive challenge: URLAuthenticationChallenge, completionHandler: @escaping (URLSession.AuthChallengeDisposition, URLCredential?) -> Void) {","        \/\/ Handle authentication challenge...","    }","}"],"type":"codeListing","syntax":"swift"},{"level":2,"text":"Resumable Downloads","type":"heading","anchor":"Resumable-Downloads"},{"inlineContent":[{"type":"text","text":"If the data task is terminated when the image is partially loaded (either because of a failure or a cancellation), the next load will resume where the previous one left off. Resumable downloads require the server to support "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/HTTP\/Range_requests"},{"type":"text","text":". Nuke supports both validators: "},{"type":"codeVoice","code":"ETag"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"Last-Modified"},{"text":". Resumable downloads are enabled by default. You can learn more in ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/kean.blog\/post\/resumable-downloads"},{"type":"text","text":"."}],"type":"paragraph"},{"type":"heading","level":2,"text":"Custom Networking Layer","anchor":"Custom-Networking-Layer"},{"type":"paragraph","inlineContent":[{"text":"If you’d like to use Alamofire for networking, it’s easy to do thanks to an ","type":"text"},{"type":"reference","isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"Alamofire plugin"}],"identifier":"https:\/\/github.com\/kean\/Nuke-Alamofire-Plugin","overridingTitle":"Alamofire plugin"},{"type":"text","text":" that allows you to load image data using "},{"type":"reference","identifier":"https:\/\/github.com\/Alamofire\/Alamofire","isActive":true},{"type":"text","text":"."}]},{"inlineContent":[{"type":"text","text":"If you’d like to use some other networking library or use your custom code, all you need to do is implement the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoading"},{"type":"text","text":" protocol consisting of a single method."}],"type":"paragraph"},{"type":"codeListing","code":["\/\/\/ Implements data loading using Alamofire framework.","public class AlamofireDataLoader: Nuke.DataLoading {","    public let session: Alamofire.Session","","    \/\/\/ Initializes the receiver with a given Alamofire.SessionManager.","    \/\/\/ - parameter session: Alamofire.Session.default by default.","    public init(session: Alamofire.Session = Alamofire.Session.default) {","        self.session = session","    }","","    \/\/ MARK: DataLoading","","    \/\/\/ Loads data using Alamofire.SessionManager.","    public func loadData(with request: URLRequest, didReceiveData: @escaping (Data, URLResponse) -> Void, completion: @escaping (Error?) -> Void) -> Cancellable {","        let task = self.session.streamRequest(request)","        task.responseStream { [weak task] stream in","            switch stream.event {","            case let .stream(result):","                switch result {","                case let .success(data):","                    guard let response = task?.response else { return } \/\/ Never nil","                    didReceiveData(data, response)","                }","            case let .complete(response):","                completion(response.error)","            }","        }","        return AnyCancellable { task.cancel() }","    }","}"],"syntax":"swift"}]}],"references":{"https://developer.apple.com/reference/foundation/urlcache":{"identifier":"https:\/\/developer.apple.com\/reference\/foundation\/urlcache","type":"link","url":"https:\/\/developer.apple.com\/reference\/foundation\/urlcache","titleInlineContent":[{"type":"codeVoice","code":"URLCache"}],"title":"URLCache"},"doc://com.github.kean.nuke/documentation/Nuke/DataLoader":{"url":"\/documentation\/nuke\/dataloader","role":"symbol","title":"DataLoader","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"DataLoader"}],"identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoader","kind":"symbol","abstract":[{"type":"text","text":"Provides basic networking using "},{"code":"URLSession","type":"codeVoice"},{"type":"text","text":"."}],"type":"topic","navigatorTitle":[{"kind":"identifier","text":"DataLoader"}]},"doc://com.github.kean.nuke/documentation/Nuke":{"identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke","url":"\/documentation\/nuke","kind":"symbol","role":"collection","type":"topic","title":"Nuke","abstract":[{"text":"A powerful image loading system for Apple platforms.","type":"text"}]},"doc://com.github.kean.nuke/documentation/Nuke/caching":{"identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/caching","abstract":[{"type":"text","text":"Learn about cache layers in Nuke and how to configure them."}],"kind":"article","role":"collectionGroup","title":"Caching","type":"topic","url":"\/documentation\/nuke\/caching"},"https://kean.blog/post/image-caching":{"identifier":"https:\/\/kean.blog\/post\/image-caching","url":"https:\/\/kean.blog\/post\/image-caching","type":"link","title":"Image Caching","titleInlineContent":[{"text":"Image Caching","type":"text"}]},"doc://com.github.kean.nuke/documentation/Nuke/DataLoading":{"role":"symbol","url":"\/documentation\/nuke\/dataloading","abstract":[{"text":"Fetches original image data.","type":"text"}],"fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"DataLoading"}],"identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoading","kind":"symbol","title":"DataLoading","navigatorTitle":[{"kind":"identifier","text":"DataLoading"}],"type":"topic"},"https://github.com/Alamofire/Alamofire":{"identifier":"https:\/\/github.com\/Alamofire\/Alamofire","type":"link","url":"https:\/\/github.com\/Alamofire\/Alamofire","titleInlineContent":[{"type":"text","text":"Alamofire.SessionManager"}],"title":"Alamofire.SessionManager"},"https://github.com/kean/Nuke-Alamofire-Plugin":{"identifier":"https:\/\/github.com\/kean\/Nuke-Alamofire-Plugin","url":"https:\/\/github.com\/kean\/Nuke-Alamofire-Plugin","type":"link","title":"Alamofire Plugin","titleInlineContent":[{"text":"Alamofire Plugin","type":"text"}]},"doc://com.github.kean.nuke/documentation/Nuke/image-formats":{"url":"\/documentation\/nuke\/image-formats","type":"topic","title":"Image Formats","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/image-formats","abstract":[{"type":"text","text":"Learn about image formats supported in Nuke and how to extend them."}],"role":"collectionGroup","kind":"article"},"doc://com.github.kean.nuke/documentation/Nuke/image-processing":{"url":"\/documentation\/nuke\/image-processing","abstract":[{"type":"text","text":"Learn how to use existing image filters and create custom ones."}],"kind":"article","type":"topic","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/image-processing","role":"collectionGroup","title":"Image Processing"},"doc://com.github.kean.nuke/documentation/Nuke/ImagePipelineDelegate":{"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ImagePipelineDelegate","kind":"identifier"}],"abstract":[{"text":"A delegate that allows you to customize the pipeline dynamically on a per-request basis.","type":"text"}],"role":"symbol","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"ImagePipelineDelegate"}],"url":"\/documentation\/nuke\/imagepipelinedelegate","type":"topic","title":"ImagePipelineDelegate","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/ImagePipelineDelegate"},"doc://com.github.kean.nuke/documentation/Nuke/DataLoader/delegate":{"fragments":[{"kind":"keyword","text":"var"},{"text":" ","kind":"text"},{"text":"delegate","kind":"identifier"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"URLSessionDelegate","preciseIdentifier":"c:objc(pl)NSURLSessionDelegate"},{"text":"?","kind":"text"}],"url":"\/documentation\/nuke\/dataloader\/delegate","abstract":[{"type":"text","text":"The delegate that gets called for the callbacks handled by the data loader."},{"type":"text","text":" "},{"type":"text","text":"You can use it for observing the session events and modifying some of the"},{"text":" ","type":"text"},{"text":"task behavior, e.g. handling authentication challenges.","type":"text"}],"kind":"symbol","type":"topic","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/DataLoader\/delegate","role":"symbol","title":"delegate"},"doc://com.github.kean.nuke/documentation/Nuke/Cancellable":{"role":"symbol","title":"Cancellable","type":"topic","url":"\/documentation\/nuke\/cancellable","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Cancellable","kind":"identifier"}],"navigatorTitle":[{"text":"Cancellable","kind":"identifier"}],"abstract":[{"type":"text","text":"A unit of work that can be cancelled."}],"kind":"symbol","identifier":"doc:\/\/com.github.kean.nuke\/documentation\/Nuke\/Cancellable"},"https://developer.apple.com/reference/foundation/nsurlsession":{"identifier":"https:\/\/developer.apple.com\/reference\/foundation\/nsurlsession","type":"link","url":"https:\/\/developer.apple.com\/reference\/foundation\/nsurlsession","titleInlineContent":[{"type":"codeVoice","code":"URLSession"}],"title":"URLSession"},"https://kean.blog/post/resumable-downloads":{"identifier":"https:\/\/kean.blog\/post\/resumable-downloads","url":"https:\/\/kean.blog\/post\/resumable-downloads","type":"link","title":"“Resumable Downloads”","titleInlineContent":[{"text":"“Resumable Downloads”","type":"text"}]},"https://github.com/kean/Pulse":{"identifier":"https:\/\/github.com\/kean\/Pulse","type":"link","url":"https:\/\/github.com\/kean\/Pulse","titleInlineContent":[{"type":"text","text":"Pulse"}],"title":"Pulse"},"https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests":{"identifier":"https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/HTTP\/Range_requests","url":"https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/HTTP\/Range_requests","type":"link","title":"HTTP Range Requests","titleInlineContent":[{"text":"HTTP Range Requests","type":"text"}]}}}