{"schemaVersion":{"minor":3,"patch":0,"major":0},"hierarchy":{"paths":[["doc:\/\/com.github.pulse\/documentation\/Pulse"]]},"seeAlsoSections":[{"identifiers":["doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger","doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxy","doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProtocol","doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxyDelegate","doc:\/\/com.github.pulse\/documentation\/Pulse\/MockingURLProtocol"],"title":"Network Logging & Debugging","anchor":"Network-Logging--Debugging","generated":true}],"primaryContentSections":[{"content":[{"level":2,"anchor":"Overview","text":"Overview","type":"heading"},{"inlineContent":[{"type":"text","text":"Pulse works on the "},{"code":"URLSession","type":"codeVoice"},{"type":"text","text":" level, and it needs access to its callbacks to log network requests and capture network metrics. The framework is modular and provides multiple options that can accommodate almost any system. By the end of this article, you will have a system that:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Captures network requests and metrics"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Supports debugging features powered by Pulse Pro, such as mocking"}]}]}]},{"type":"heading","level":2,"anchor":"Capture-Network-Requests","text":"Capture Network Requests"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The first step is to capture network traffic."}]},{"level":3,"text":"Option 1 (Recommended)","anchor":"Option-1-Recommended","type":"heading"},{"inlineContent":[{"text":"Use ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxy"},{"text":", a thin wrapper on top of ","type":"text"},{"type":"codeVoice","code":"URLSession"},{"type":"text","text":"."}],"type":"paragraph"},{"code":["import Pulse","","#if DEBUG","let session: URLSessionProtocol = URLSessionProxy(configuration: .default)","#else","let session: URLSessionProtocol = URLSession(configuration: .default)","#endif"],"syntax":"swift","type":"codeListing"},{"inlineContent":[{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxy","isActive":true,"type":"reference"},{"text":" is the best way to integrate Pulse because it supports all ","type":"text"},{"code":"URLSession","type":"codeVoice"},{"type":"text","text":" APIs, including the new Async\/Await methods. It also makes it easy to remove it conditionally."}],"type":"paragraph"},{"type":"heading","anchor":"Option-2-Quickest","level":3,"text":"Option 2 (Quickest)"},{"inlineContent":[{"text":"If you are evaluating the framework, the quickest way to get started is with a proxy from the ","type":"text"},{"type":"strong","inlineContent":[{"text":"PulseProxy","type":"text"}]},{"text":" module.","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["import PulseProxy","","#if DEBUG","NetworkLogger.enableProxy()","#endif"],"syntax":"swift"},{"name":" Important","type":"aside","content":[{"inlineContent":[{"type":"text","text":""},{"inlineContent":[{"type":"text","text":"PulseProxy"}],"type":"strong"},{"type":"text","text":" uses method swizzling and private APIs, and it is not recommended that you include it in the production builds of your app. It is also not guaranteed to continue working with new versions of the system SDKs."}],"type":"paragraph"}],"style":"note"},{"anchor":"Option-3","level":3,"type":"heading","text":"Option 3"},{"inlineContent":[{"type":"text","text":"If you use a delegate-based "},{"type":"codeVoice","code":"URLSession"},{"text":" that doesn’t rely on any of its convenience APIs, such as ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/Alamofire\/Alamofire"},{"type":"text","text":", you can record its traffic using "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxyDelegate"},{"type":"text","text":"."}],"type":"paragraph"},{"code":["let delegate = URLSessionProxyDelegate(delegate: <#YourSessionDelegate#>)","let session = URLSession(configuration: .default, delegate: delegate, delegateQueue: nil)"],"syntax":"swift","type":"codeListing"},{"name":"Important","type":"aside","style":"important","content":[{"type":"paragraph","inlineContent":[{"text":"This method supports a limited subset of scenarios and doesn’t work with ","type":"text"},{"type":"codeVoice","code":"URLSession"},{"type":"text","text":" Async\/Await APIs."}]}]},{"anchor":"Option-4-Manual","level":3,"text":"Option 4 (Manual)","type":"heading"},{"inlineContent":[{"text":"If none of the convenience APIs described earlier work for you, you can use the underlying ","type":"text"},{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger","isActive":true,"type":"reference"},{"type":"text","text":" directly. For example, here is how you can use it with Alamofire’s "},{"code":"EventMonitor","type":"codeVoice"},{"type":"text","text":":"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["import Alamofire","","let session = Alamofire.Session(eventMonitors: [NetworkLoggerEventMonitor()])","","struct NetworkLoggerEventMonitor: EventMonitor {","    var logger: NetworkLogger = .shared","","    func request(_ request: Request, didCreateTask task: URLSessionTask) {","        logger.logTaskCreated(task)","    }","","    func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data) {","        logger.logDataTask(dataTask, didReceive: data)","    }","","    func urlSession(_ session: URLSession, task: URLSessionTask, didFinishCollecting metrics: URLSessionTaskMetrics) {","        logger.logTask(task, didFinishCollecting: metrics)","    }","","    func urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?) {","        logger.logTask(task, didCompleteWithError: error)","    }","}"]},{"inlineContent":[{"type":"text","text":"Alternatively, if you don’t have access to "},{"code":"URLSessionTask","type":"codeVoice"},{"text":", you can store the request\/response directly in ","type":"text"},{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/LoggerStore","isActive":true,"type":"reference"},{"text":":","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["LoggerStore.shared.storeRequest(urlRequest, response: urlResponse, ...)"],"syntax":"swift"},{"anchor":"Configure-Logging","type":"heading","level":2,"text":"Configure Logging"},{"anchor":"Record-Decoding-Errors","level":3,"type":"heading","text":"Record Decoding Errors"},{"type":"paragraph","inlineContent":[{"text":"The network requests can only be considered successful when the app decodes the response data. With Pulse, you can do just that, and when you open the response body, it’ll even highlight the part of the response causing the decoding error.","type":"text"}]},{"syntax":"swift","code":["\/\/ Initial setup","var configuration = NetworkLogger.Configuration()","configuration.isWaitingForDecoding = true","","let logger = NetworkLogger(configuration: configuration)","","let session = NetworkLogger.URLSession(configuration: .default, logger: logger)","","\/\/ Add this to the code that performs decoding of the responses.","logger.logTask(task, didFinishDecodingWithError: decodingError)"],"type":"codeListing"},{"type":"heading","level":3,"anchor":"Exclude-Information-From-Logs","text":"Exclude Information From Logs"},{"inlineContent":[{"isActive":true,"type":"reference","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger"},{"type":"text","text":" captures data safely in a local database, and it never leaves your device. Logs are never written to the system’s logging system. But, of course, logs are meant to be viewed and shared, which is why PulseUI provides sharing options. In case the logs do leave your device, it’s best to redact any sensitive information. "}],"type":"paragraph"},{"inlineContent":[{"isActive":true,"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Configuration","type":"reference"},{"type":"text","text":" has a set of convenience APIs for managing what information is included or excluded from the logs."}],"type":"paragraph"},{"syntax":"swift","code":["var configuration = NetworkLogger.Configuration()","","\/\/ Includes only requests with the given domain.","configuration.includedHosts = [\"*.example.com\"]","","\/\/ Exclude some subdomains.","configuration.excludedHosts = [\"logging.example.com\"]","","\/\/ Exclude specific URLs.","configuration.excludedURLs = [\"*\/log\/event\"]","","\/\/ Replaces values for the given HTTP headers with \"<private>\"","configuration.sensitiveHeaders = [\"Authorization\", \"Access-Token\"]","","\/\/ Redacts sensitive query items.","configuration.sensitiveQueryItems = [\"password\"]","","\/\/ Replaces values for the given response and request JSON fields with \"<private>\"","configuration.sensitiveDataFields = [\"password\"]","","let logger = NetworkLogger(configuration: configuration)"],"type":"codeListing"},{"inlineContent":[{"text":"You can then replace the default decoder with your custom instance:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["NetworkLogger.shared = logger"]},{"type":"aside","style":"tip","content":[{"inlineContent":[{"text":"“Include” and “exclude” patterns support basic wildcards (","type":"text"},{"type":"codeVoice","code":"*"},{"type":"text","text":"), but you can also turn them into full-featured regex patterns using "},{"type":"reference","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Configuration\/isRegexEnabled","isActive":true},{"text":". ","type":"text"}],"type":"paragraph"}],"name":"Tip"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the built-in configuration options don’t cover all of your use cases, you can set the "},{"type":"reference","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Configuration\/willHandleEvent","isActive":true},{"type":"text","text":" closure that provides you complete control for filtering out and updating the events."}]},{"style":"important","type":"aside","name":"Important","content":[{"inlineContent":[{"text":"If you redact information manually from requests or responses, also update ","type":"text"},{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Metrics","isActive":true,"type":"reference"},{"text":" because individual transactions within metrics contain recorded request and response pairs.","type":"text"}],"type":"paragraph"}]},{"level":3,"text":"Trace in Xcode Console","anchor":"Trace-in-Xcode-Console","type":"heading"},{"inlineContent":[{"text":"Pulse doesn’t print anything in the Xcode Console by default, but it’s easy to enable  logging for network requests. ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/LoggerStore"},{"text":" re-translates all of the log events that it processes using ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/LoggerStore\/events"},{"text":" publisher that you can leverage.","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["func register(store: LoggerStore) {","    cancellable = store.events.receive(on: queue).sink { [weak self] in","        self?.process(event: $0)","    }","}","","private func process(event: LoggerStore.Event) {","    switch event {","    case .networkTaskCompleted(let event):","        \/\/ Log any information you need from event in any format you like.","    default:","        break","    }","}"]},{"type":"heading","level":2,"anchor":"Network-Debugging","text":"Network Debugging"},{"type":"paragraph","inlineContent":[{"text":"In addition to logging, Pulse provides network debugging features, such as logging. If you use the recommended ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxy"},{"text":", these features are enabled automatically, and you don’t need to do anything. In other cases, make sure to inject ","type":"text"},{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/MockingURLProtocol","isActive":true,"type":"reference"},{"type":"text","text":" in the set of URL protocols used by your "},{"code":"URLSession","type":"codeVoice"},{"type":"text","text":":"}]},{"type":"codeListing","syntax":"swift","code":["let configuration = URLSesionConfiguration.default","configuration.protocolClasses = [MockingURLProtocol.self] + (configuration.protocolClasses ?? [])"]},{"inlineContent":[{"type":"text","text":"Alternatively, you can use automatic registration."}],"type":"paragraph"},{"code":["MockingURLProtocol.enableAutomaticRegistration()"],"type":"codeListing","syntax":"swift"}],"kind":"content"}],"kind":"article","variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/pulse\/networklogging-article"]}],"sections":[],"metadata":{"title":"Network Logging & Debugging","role":"article","roleHeading":"Article","modules":[{"name":"Pulse"}]},"identifier":{"url":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogging-Article","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Learn how to enable and configure network logging and debugging."}],"references":{"doc://com.github.pulse/documentation/Pulse/URLSessionProxy":{"title":"URLSessionProxy","kind":"symbol","url":"\/documentation\/pulse\/urlsessionproxy","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"text":"URLSessionProxy","kind":"identifier"}],"navigatorTitle":[{"text":"URLSessionProxy","kind":"identifier"}],"type":"topic","abstract":[{"type":"text","text":"A thin wrapper on top of "},{"type":"codeVoice","code":"URLSession"},{"text":" that simplifies logging of network","type":"text"},{"type":"text","text":" "},{"text":"requests and enables other Pulse features.","type":"text"}],"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxy","role":"symbol"},"doc://com.github.pulse/documentation/Pulse/LoggerStore/events":{"type":"topic","url":"\/documentation\/pulse\/loggerstore\/events","fragments":[{"text":"let","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"events"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"PassthroughSubject","preciseIdentifier":"s:7Combine18PassthroughSubjectC"},{"kind":"text","text":"<"},{"text":"LoggerStore","kind":"typeIdentifier","preciseIdentifier":"s:5Pulse11LoggerStoreC"},{"text":".","kind":"text"},{"kind":"typeIdentifier","text":"Event","preciseIdentifier":"s:5Pulse11LoggerStoreC5EventO"},{"text":", ","kind":"text"},{"kind":"typeIdentifier","text":"Never","preciseIdentifier":"s:s5NeverO"},{"text":">","kind":"text"}],"role":"symbol","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/LoggerStore\/events","title":"events","kind":"symbol","abstract":[{"text":"Re-transmits events processed by the store.","type":"text"}]},"https://github.com/Alamofire/Alamofire":{"titleInlineContent":[{"text":"Alamofire","type":"text"}],"url":"https:\/\/github.com\/Alamofire\/Alamofire","type":"link","identifier":"https:\/\/github.com\/Alamofire\/Alamofire","title":"Alamofire"},"doc://com.github.pulse/documentation/Pulse/LoggerStore":{"title":"LoggerStore","abstract":[{"type":"text","text":"Persistently stores logs, network requests, and response blobs."}],"url":"\/documentation\/pulse\/loggerstore","role":"symbol","type":"topic","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"LoggerStore"}],"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/LoggerStore","navigatorTitle":[{"text":"LoggerStore","kind":"identifier"}],"kind":"symbol"},"doc://com.github.pulse/documentation/Pulse/NetworkLogger/Configuration/isRegexEnabled":{"url":"\/documentation\/pulse\/networklogger\/configuration\/isregexenabled","type":"topic","abstract":[{"type":"text","text":"If enabled, processes "},{"type":"codeVoice","code":"include"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"exclude"},{"text":" patterns using regex.","type":"text"},{"text":" ","type":"text"},{"text":"By default, patterns support only basic wildcard syntax: ","type":"text"},{"code":"*.example.com","type":"codeVoice"},{"text":".","type":"text"}],"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Configuration\/isRegexEnabled","title":"isRegexEnabled","fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"isRegexEnabled"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:Sb","text":"Bool"}],"role":"symbol","kind":"symbol"},"doc://com.github.pulse/documentation/Pulse/NetworkLogger":{"kind":"symbol","url":"\/documentation\/pulse\/networklogger","role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"NetworkLogger","kind":"identifier"}],"type":"topic","abstract":[{"text":"A wrapper on top of ","type":"text"},{"isActive":true,"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/LoggerStore","type":"reference"},{"text":" that simplifies logging of network requests.","type":"text"}],"navigatorTitle":[{"text":"NetworkLogger","kind":"identifier"}],"title":"NetworkLogger","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger"},"doc://com.github.pulse/documentation/Pulse/URLSessionProtocol":{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProtocol","navigatorTitle":[{"text":"URLSessionProtocol","kind":"identifier"}],"type":"topic","title":"URLSessionProtocol","role":"symbol","kind":"symbol","url":"\/documentation\/pulse\/urlsessionprotocol","abstract":[],"fragments":[{"kind":"keyword","text":"protocol"},{"text":" ","kind":"text"},{"kind":"identifier","text":"URLSessionProtocol"}]},"doc://com.github.pulse/documentation/Pulse":{"title":"Pulse","url":"\/documentation\/pulse","abstract":[{"text":"Logger and network inspector for Apple platforms.","type":"text"}],"role":"collection","type":"topic","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse","kind":"symbol"},"doc://com.github.pulse/documentation/Pulse/URLSessionProxyDelegate":{"url":"\/documentation\/pulse\/urlsessionproxydelegate","title":"URLSessionProxyDelegate","role":"symbol","navigatorTitle":[{"text":"URLSessionProxyDelegate","kind":"identifier"}],"abstract":[{"type":"text","text":"Automates URLSession request tracking."}],"fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"URLSessionProxyDelegate","kind":"identifier"}],"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/URLSessionProxyDelegate","type":"topic","kind":"symbol"},"doc://com.github.pulse/documentation/Pulse/NetworkLogger/Metrics":{"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Metrics","kind":"symbol","role":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Metrics","kind":"identifier"}],"title":"NetworkLogger.Metrics","type":"topic","abstract":[],"url":"\/documentation\/pulse\/networklogger\/metrics","navigatorTitle":[{"kind":"identifier","text":"Metrics"}]},"doc://com.github.pulse/documentation/Pulse/MockingURLProtocol":{"fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"MockingURLProtocol"}],"abstract":[{"text":"A custom ","type":"text"},{"type":"codeVoice","code":"URLProtocol"},{"text":" that enables Pulse network debugging features such","type":"text"},{"type":"text","text":" "},{"text":"as mocking of the network responses.","type":"text"}],"kind":"symbol","url":"\/documentation\/pulse\/mockingurlprotocol","role":"symbol","type":"topic","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/MockingURLProtocol","title":"MockingURLProtocol","navigatorTitle":[{"kind":"identifier","text":"MockingURLProtocol"}]},"doc://com.github.pulse/documentation/Pulse/NetworkLogger/Configuration/willHandleEvent":{"role":"symbol","kind":"symbol","title":"willHandleEvent","identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Configuration\/willHandleEvent","abstract":[{"type":"text","text":"Gets called when the logger receives an event. You can use it to"},{"text":" ","type":"text"},{"text":"modify the event before it is stored in order, for example, filter","type":"text"},{"type":"text","text":" "},{"text":"out some sensitive information. If you return ","type":"text"},{"type":"codeVoice","code":"nil"},{"type":"text","text":", the event"},{"type":"text","text":" "},{"text":"is ignored completely.","type":"text"}],"fragments":[{"text":"var","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"willHandleEvent"},{"kind":"text","text":": ("},{"text":"LoggerStore","kind":"typeIdentifier","preciseIdentifier":"s:5Pulse11LoggerStoreC"},{"text":".","kind":"text"},{"preciseIdentifier":"s:5Pulse11LoggerStoreC5EventO","kind":"typeIdentifier","text":"Event"},{"kind":"text","text":") -> "},{"text":"LoggerStore","preciseIdentifier":"s:5Pulse11LoggerStoreC","kind":"typeIdentifier"},{"text":".","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:5Pulse11LoggerStoreC5EventO","text":"Event"},{"text":"?","kind":"text"}],"url":"\/documentation\/pulse\/networklogger\/configuration\/willhandleevent","type":"topic"},"doc://com.github.pulse/documentation/Pulse/NetworkLogger/Configuration":{"title":"NetworkLogger.Configuration","abstract":[{"text":"The logger configuration.","type":"text"}],"type":"topic","kind":"symbol","url":"\/documentation\/pulse\/networklogger\/configuration","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Configuration"}],"role":"symbol","navigatorTitle":[{"text":"Configuration","kind":"identifier"}],"identifier":"doc:\/\/com.github.pulse\/documentation\/Pulse\/NetworkLogger\/Configuration"}}}